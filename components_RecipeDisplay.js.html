<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: components/RecipeDisplay.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: components/RecipeDisplay.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import { database } from '../scripts/database.js';

/**
 * recipe-display.js
 *
 * @author Lynn Dang
 * Taken from Lab 7
 */
class RecipeDisplay extends HTMLElement {
  static jSConfetti = new JSConfetti();
  /**
   * Constructor builds the layout for the recipe page
   */
  constructor() {
    super();
    // Create Shadow DOM
    this.attachShadow({ mode: 'open' });
    const styles = document.createElement('style');
    const article = document.createElement('article');
    styles.innerHTML = `
      .main-container {
        max-width: 900px;
        margin: auto;
      }
      .recipe-section {
        background-color: #ee6858;
        padding: 20px 40px;
        border-radius: 25px;
      }
      
      /* generic button */
      .button-wrapper > button{
        padding: 5px;
        font-size: 18px;
      }

      button {
        background-color: white;
        border-radius: 20px;
        font-family: 'Mochiy Pop P One', sans-serif;
        border: 2px solid black;
        cursor: pointer;
      }

      button:active {
        background-color: rgb(187, 187, 187);
      }
      
      #recipe-media > img {
        display: block;
        width: 75%;
        align-content: center;
        margin-left: auto;
        margin-right: auto;
        height: auto;
        border: 1px black
      }

      .recipe-title {
        font-size: 50px;
        font-family: 'Mochiy Pop P One', sans-serif;
        padding: 0px;
        margin: 0px;
      }
      
      .recipe-about {
        display: grid;
        align-items: end;
        grid-template-columns: 1fr 0.5fr;
        padding-bottom: 30px;
      }
      
      .recipe-about .recipe-description {
        grid-row: 1 / 3
      }
      
      completed {
        text-align: center;
      }

      
      .recipe-spice-info {
        display: flex;
        justify-content: flex-end;
        align-items: center;
      }
      
      .recipe-spice-info > img {
        display: inline-block;
        object-fit: scale-down;
        width: 78px;
        padding: 0 5px;
        border-right: 4px
      }
      
      .recipe-about .button-wrapper {
        grid-column: 2 / 3;
        justify-self: end;
      }
      
      #recipe-information {
        margin: 10px;
        padding: 10px;
        border: 2px solid black;
        border-radius: 20px;
        background: white;
      }
      
      #recipe-information > span {
        display: flex;
        justify-content: space-between;
        height: auto;
      }
      
      .recipe-subtitle {
        font-size: 35px;
        margin-bottom: 20px;
        margin-top: 0px;
      }

      #recipe-ingredients {
        border: 2px solid black;
        padding: 15px;
        background: white;
        max-width: 765px;
        margin: auto;
      }
      
      .ingredient-list {
        columns: 2;
        -webkit-columns: 2;
        -moz-columns: 2;
        padding: 10px;
      }

      #recipe-directions {
        border: 2px solid black;
        padding: 15px;
        background: white;
        max-width: 765px;
        margin: auto;
      }

      .recipe-list {
        display: flex;
        flex-direction: column;
        row-gap: 10px;
        padding: 10px;  
      }

      li {
        break-inside: avoid-column;
        list-style: none;
        margin-left: 8px;
      }
      
      input[type="checkbox"] {
        margin-left: -8px;
      }

      .challenge-header > li {
        margin-left: 8px;
        list-style: disc;
      }  
     
      input[type="button"]  {
        background-color: white;
        border-radius: 20px;
        font-family: 'Mochiy Pop P One', sans-serif;
        border: 2px solid black;
        cursor: pointer;
      }

      .reaction-wrapper-img {
        display: block;
        justify-content: center;
        align-items: right;
        margin-right: auto;
        margin-left: auto;
        width: 50%;
      }

      .reaction-wrapper > :not(input[type="button"]) {
        display: block;
        justify-content: center;
        align-items: right;
        margin-right: auto;
        margin-left: auto;
        width: 23%;
      }

      .reaction-wrapper > input[type="button"] {
        display: block;
        justify-content: center;
        align-items: right;
        margin-right: auto;
        margin-left: auto;
        width: 80px;
      }

      input[type="button"]:active {
        background-color: rgb(187, 187, 187);
      }

      .button-wrapper {
        display: flex;
        justify-content: center;
        align-items: center;
      }

      hr {
        border-color: black;
      }

      @media (prefers-color-scheme: dark) {
        .recipe-section {
          background-color: var(--bg-color-red);
        }

        h1, input[type="file" i], completed {
          color: var(--font-color);
        }

        .recipe-description {
          color: var(--font-color);
          font-weight: bold;
        }

        #recipe-media > img {
          border: 1px solid var(--border-color);
        }
  
        img {
          opacity: .75;
          transition: opacity .5s ease-in-out;
          
        }

        button, input[type="file" i]::-webkit-file-upload-button {
          background-color: var(--bg-color);
          color: var(--font-color);
          border: 1px solid var(--border-color);
          cursor: pointer;
        }

        #recipe-information, 
        #recipe-ingredients, 
        #recipe-directions {
          background-color: var(--bg-color);
          color: var(--font-color);
          border: 2px solid var(--border-color);
        }

        input[type='button']{
          background-color: var(--bg-color);
          border: 2px solid var(--border-color);
          color: var(--font-color);
        }

        ol {
          color: var(--font-color);
        }
      }
    `;
    article.innerHTML = `
      &lt;div class="main-container">
        &lt;main>
          &lt;article class="recipe-section">
            &lt;div class="recipe-header">
              &lt;h1>&lt;/h1>
              &lt;div class="recipe-about">
                &lt;p class="recipe-description">
                &lt;/p>
                  &lt;div class="recipe-spice-info">
                    &lt;img src="">
                    &lt;p id="recipe-spice-level">&lt;/p>    
                  &lt;/div>
              &lt;/div>      
            &lt;/div>
            &lt;div id="recipe-media">
              &lt;img src="">
            &lt;/div>
            &lt;div id="recipe-information">
              &lt;span id="recipe-prep-time">
                &lt;p class="recipe-info-name">Prep Time:&lt;/p>
                &lt;p class="recipe-info-number">&lt;/p>
              &lt;/span>
              &lt;span id="recipe-cook-time">
                &lt;p class="recipe-info-name">Cook Time:&lt;/p>
                &lt;p class="info-number">&lt;/p>
              &lt;/span>
              &lt;span id="recipe-serving-size">
                &lt;p class="recipe-info-name">Serving Size:&lt;/p>
                &lt;p class="recipe-info-number">&lt;/p>
              &lt;/span>
            &lt;/div>
            &lt;div id="recipe-ingredients">
              &lt;h3 class="recipe-subtitle">Ingredients&lt;/h3>
              &lt;ul class="ingredient-list">
              &lt;/ul>
            &lt;/div>
            &lt;br>
            &lt;div id="recipe-directions">
              &lt;h3 class="recipe-subtitle">Directions&lt;/h3>
              &lt;ul class="recipe-list">
              &lt;/ul>
            &lt;/div>
            &lt;br>
            &lt;div class="button-wrapper">
              &lt;button class="recipe-button" id="made-this-button">I Made This!&lt;/button>
            &lt;/div>
            &lt;br>
            &lt;div class="reaction-wrapper-img">
              &lt;img style="display:none;" src="assets/images/placeholder.png" id="imgPreview" alt="temp" width="400" height="400" referrerpolicy="no-referrer">
              &lt;br>
            &lt;/div>
            &lt;div class="reaction-wrapper">
                &lt;input style="display:none;" type="file" id="imgUpload" accept="image/*">&lt;/input>
                &lt;br>
            &lt;/div>
            &lt;div class="reaction-wrapper">
                &lt;input style="display:none;" id="submitButton" class="Submit" type="button" value="Submit">
            &lt;/div>
          &lt;/article>
        &lt;/main>
      &lt;/div>
      `;
    this.shadowRoot.append(styles, article);
  }

  GetImgurImage() {
    const imgUpload = this.shadowRoot.getElementById('imgUpload');
    const imgPreview = this.shadowRoot.getElementById('imgPreview');
    // const url = this.shadowRoot.getElementById('url');
    imgUpload.addEventListener('change', (ev) => {
      const formdata = new FormData();
      formdata.append('image', ev.target.files[0]);
      fetch('https://api.imgur.com/3/image/', {
        method: 'post',
        headers: {
          Authorization: 'Client-ID 0f695d3611373b4',
        },
        body: formdata,
      }).then((data) => data.json()).then((data) => {
        imgPreview.src = data.data.link;
      });
    });
  }

  /**
   * Sets the recipe that will be used inside the &lt;recipe-display> element.
   * Overwrites the previous recipe displayed.
   */
  set data(data) {
    this.json = data;
    console.log(JSON.stringify(data));
    // Reset HTML
    this.shadowRoot.querySelector('article').innerHTML = `
        &lt;div class="main-container">
          &lt;main>
            &lt;article class="recipe-section">
              &lt;div class="recipe-header">
                &lt;h1 class="recipe-title">&lt;/h1>
                &lt;div class="recipe-about">
                  &lt;p class="recipe-description">&lt;/p>
                    &lt;div class="recipe-spice-info">
                      &lt;img src="">
                      &lt;p id="recipe-spice-level">&lt;/p>    
                    &lt;/div>
                    &lt;div class="button-wrapper">
                      &lt;button id="editButton" class="edit-button">Edit&lt;/button>
                    &lt;/div>  
                &lt;/div>      
              &lt;/div>
              &lt;div id="recipe-media">
                &lt;img src="">
              &lt;/div>
              &lt;div id="recipe-information">
                &lt;span id="recipe-prep-time">
                  &lt;p class="recipe-info-name">Prep Time:&lt;/p>
                  &lt;p class="recipe-info-number">&lt;/p>
                &lt;/span>
                &lt;span id="recipe-cook-time">
                  &lt;p class="recipe-info-name">Cook Time:&lt;/p>
                  &lt;p class="recipe-info-number">&lt;/p>
                &lt;/span>
                &lt;span id="recipe-serving-size">
                  &lt;p class="recipe-info-name">Serving Size:&lt;/p>
                  &lt;p class="recipe-info-number">&lt;/p>
                &lt;/span>
              &lt;/div>
              &lt;div id="recipe-ingredients">
                &lt;h3 class="recipe-subtitle">Ingredients&lt;/h3>
                &lt;ul class="ingredient-list">
                &lt;/ul>
              &lt;/div>
              &lt;br>
              &lt;div id="recipe-directions">
                &lt;h3 class="recipe-subtitle">Directions&lt;/h3>
                &lt;ul class="recipe-list">
                &lt;/ul>
              &lt;/div>
              &lt;br>
              &lt;div class="button-wrapper">
                &lt;button class="recipe-button" id="made-this-button">I Made This!&lt;/button>
              &lt;/div>
              &lt;br>
              &lt;div class="reaction-wrapper-img">
                &lt;img style="display:none;" src="assets/images/placeholder.png" id="imgPreview" alt="temp" width="400" height="400" referrerpolicy="no-referrer">
                &lt;br>
              &lt;/div>
              &lt;div class="reaction-wrapper">
                &lt;input style="display:none;" type="file" id="imgUpload" accept="image/*">&lt;/input>
                &lt;br>
              &lt;/div>
              &lt;div class="reaction-wrapper">
                &lt;input style="display:none;" id="submitButton" class="Submit" type="button" value="Submit">
              &lt;/div>
            &lt;/article>
          &lt;/main>
        &lt;/div>
    `;
    const { title } = data;
    this.shadowRoot.querySelector('h1').innerHTML = title;
    const { description } = data;
    this.shadowRoot.querySelector('.recipe-description').innerHTML = description;
    const { image } = data;
    const img = this.shadowRoot.querySelector('#recipe-media > img');
    if (image == "") {
      img.setAttribute('src', "assets/images/placeholder.png");
    }
    else {
      img.setAttribute('src', image);
    }
    img.setAttribute('alt', title);
    //const { scoville } = data;
    //this.shadowRoot.querySelector('#recipe-spice-level').innerHTML = scoville;
    for (let i = 0; i &lt; data.spiceRating; i += 1) {
      this.shadowRoot.querySelector('#recipe-spice-level').innerHTML += 'ðŸŒ¶ï¸';
    }
    const prepTime = calculateTime(data.time[0]);
    this.shadowRoot.querySelector('#recipe-prep-time > .recipe-info-number').innerHTML = prepTime;
    const cookTime = calculateTime(data.time[1]);
    this.shadowRoot.querySelector('#recipe-cook-time > .recipe-info-number').innerHTML = cookTime;
    const { servingSize } = data;
    this.shadowRoot.querySelector('#recipe-serving-size > .recipe-info-number').innerHTML = servingSize;
    const { ingredientList } = data;
    ingredientList.forEach((ingredient) => {
      const ingredientString = getIngredient(ingredient);
      const ingredientContainer = createCheckbox(ingredientString);
      this.shadowRoot.querySelector('#recipe-ingredients > .ingredient-list').appendChild(ingredientContainer);
    });
    const { directions } = data;
    directions.forEach((direction) => {
      const directionContainer = createCheckbox(direction);
      this.shadowRoot.querySelector('#recipe-directions > .recipe-list').appendChild(directionContainer);
    });
    const btn = this.shadowRoot.getElementById('made-this-button');
    if (data.completed === true) {
      const newBox = document.createElement('completed');
      newBox.innerHTML = 'Completed!';
      newBox.innerHTML += "&lt;br>&lt;br>Upload a picture of your reaction!";
      btn.parentElement.appendChild(newBox);
      const box = btn.parentElement;
      btn.parentElement.removeChild(btn);
      const uploadImg = this.shadowRoot.getElementById('imgUpload');
      const submitBtn = this.shadowRoot.getElementById('submitButton');
      const imgPreview = this.shadowRoot.getElementById('imgPreview');
      uploadImg.style.display = '';
      submitBtn.style.display = '';
      imgPreview.style.display = '';
      if ('reactions' in data) {
        imgPreview.src = data.reactions;
      }
      this.GetImgurImage();
      this.SubmitReaction();
    } else {
      this.bindCompleteButton(data);
    }
    if(data.challenges.length != 0 ){
      this.ShowChallenge(data);
    }
  }

  SubmitReaction() {
    const button = this.shadowRoot.getElementById('submitButton');
    const uploadImg = this.shadowRoot.getElementById('imgUpload');
    const submitBtn = this.shadowRoot.getElementById('submitButton');
    button.addEventListener('click', () => {
      const imgPreview = this.shadowRoot.getElementById('imgPreview');
      this.json.reactions = imgPreview.src;
      database.updateRecipe(this.json);
    });
  }

  bindCompleteButton(data) {
    const btn = this.shadowRoot.getElementById('made-this-button');
    btn.addEventListener('click', () => {
      RecipeDisplay.jSConfetti.addConfetti( {emojis: ['ðŸ¥µ', 'ðŸ”¥', 'ðŸŒ¶ï¸']} );
      if (data.completed === false) {
        database.completeRecipe(data);
        const newBox = document.createElement('completed');
        newBox.innerHTML = 'Completed!';
        newBox.innerHTML += "&lt;br>&lt;br>Upload a picture of your reaction!";
        btn.parentElement.appendChild(newBox);
        btn.parentElement.removeChild(btn);
        const imgPreview = this.shadowRoot.getElementById('imgPreview');
        imgPreview.style.display = '';
        const uploadImg = this.shadowRoot.getElementById('imgUpload');
        uploadImg.style.display = '';
        const submitBtn = this.shadowRoot.getElementById('submitButton');
        submitBtn.style.display = '';
        this.GetImgurImage();
        this.SubmitReaction();
      }
    });
  }
  ShowChallenge(data) {
    const dummyChild = this.shadowRoot.getElementById('recipe-directions');
    const challengeHeader = document.createElement('ol');
    challengeHeader.classList.add('challenge-header');
    challengeHeader.innerHTML = '&lt;br>&lt;br>Included in Challenges'; 
    data.challenges.forEach((childChallenge) => { 
      const li = document.createElement('li'); 
      li.innerHTML = childChallenge; 
      challengeHeader.append(li); 
    });
    dummyChild.parentElement.appendChild(challengeHeader); 
  }
}
/**
 * Calculates the time string to display
 * @param {*} time
 * @returns string to display time
 */
function calculateTime(time) {
  let timeString = '';
  if (time.hours > 0) {
    timeString += `${time.hours} hours`;
    if (time.minutes > 0) {
      timeString += `, ${time.minutes} minutes`;
    }
  } else {
    timeString += `${time.minutes} minutes`;
  }
  return timeString;
}
/**
 * Parses the ingredient JSON to make it into a readable string to
 * display the ingredient
 * @param {*} ingredient
 * @returns string to display ingredient
 */
function getIngredient(ingredient) {
  const { name } = ingredient;
  const { quantity } = ingredient;
  const { units } = ingredient;
  let ingredientString = '';
  if (quantity !== 0) {
    ingredientString += `${quantity} `;
  }
  if (units !== 'N/A') {
    ingredientString += `${units} `;
  }
  ingredientString += name;
  return ingredientString;
}
/**
 * Creates a checkbox given the string
 * @param {*} checkboxString
 * @returns the checkbox container
 */
function createCheckbox(checkboxString) {
  const container = document.createElement('li');
  const checkbox = document.createElement('input');
  checkbox.setAttribute('type', 'checkbox');
  container.appendChild(checkbox);
  container.appendChild(document.createTextNode(checkboxString));
  return container;
}

customElements.define('recipe-display', RecipeDisplay);
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="ChallengeBar.html">ChallengeBar</a></li><li><a href="RecipeCard.html">RecipeCard</a></li><li><a href="RecipeDisplay.html">RecipeDisplay</a></li><li><a href="RecipeUpload.html">RecipeUpload</a></li><li><a href="Router_Router.html">Router</a></li></ul><h3>Global</h3><ul><li><a href="global.html#addCreateRecipe">addCreateRecipe</a></li><li><a href="global.html#addRecipe">addRecipe</a></li><li><a href="global.html#bindCancelButton">bindCancelButton</a></li><li><a href="global.html#bindCreateRecipe">bindCreateRecipe</a></li><li><a href="global.html#bindDeleteButton">bindDeleteButton</a></li><li><a href="global.html#bindEditButton">bindEditButton</a></li><li><a href="global.html#bindEscKey">bindEscKey</a></li><li><a href="global.html#bindPopstate">bindPopstate</a></li><li><a href="global.html#bindProgressBar">bindProgressBar</a></li><li><a href="global.html#bindRecipeCard">bindRecipeCard</a></li><li><a href="global.html#bindSlider">bindSlider</a></li><li><a href="global.html#bindSubmitButton">bindSubmitButton</a></li><li><a href="global.html#calculateTime">calculateTime</a></li><li><a href="global.html#clickLogoToGoHome">clickLogoToGoHome</a></li><li><a href="global.html#completeRecipe">completeRecipe</a></li><li><a href="global.html#countRecipes">countRecipes</a></li><li><a href="global.html#createCheckbox">createCheckbox</a></li><li><a href="global.html#createProgressBars">createProgressBars</a></li><li><a href="global.html#createRecipeCards">createRecipeCards</a></li><li><a href="global.html#dataURItoBlob">dataURItoBlob</a></li><li><a href="global.html#deleteRecipe">deleteRecipe</a></li><li><a href="global.html#displaySearchCards">displaySearchCards</a></li><li><a href="global.html#getById">getById</a></li><li><a href="global.html#getByName">getByName</a></li><li><a href="global.html#getBySpice">getBySpice</a></li><li><a href="global.html#getChallenges">getChallenges</a></li><li><a href="global.html#getIngredient">getIngredient</a></li><li><a href="global.html#init">init</a></li><li><a href="global.html#loadChallengesFromFile">loadChallengesFromFile</a></li><li><a href="global.html#loadDB">loadDB</a></li><li><a href="global.html#saveChallenges">saveChallenges</a></li><li><a href="global.html#saveDB">saveDB</a></li><li><a href="global.html#sliderSpiceLevel">sliderSpiceLevel</a></li><li><a href="global.html#triggerSlider">triggerSlider</a></li><li><a href="global.html#updateRecipe">updateRecipe</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.4</a> on Fri Dec 10 2021 07:01:13 GMT+0000 (Coordinated Universal Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
